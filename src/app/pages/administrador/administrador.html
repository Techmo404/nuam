<header class="d-flex align-items-center justify-content-between px-3 py-2" style="background-color:#003366;color:white;">
  <div class="d-flex align-items-center">
    <img src="https://www.biobiochile.cl/assets/logos-notas-patrocinadas/6341953_logo_img_patrocinada.png" alt="Logo NUAM" class="logo" style="height:40px;margin-right:10px;">
    <h4 class="m-0">Sistema de Calificaciones Tributarias - NUAM</h4>
  </div>

  <div class="dropdown text-end">
    <button class="btn btn-outline-light dropdown-toggle" type="button" data-bs-toggle="dropdown">
      âš™ï¸ Administrador NUAM
    </button>
    <ul class="dropdown-menu dropdown-menu-end">
      <li><h6 class="dropdown-header">Administrador</h6></li>
      <li><span class="dropdown-item-text text-muted small">Rol: Administrador del Sistema</span></li>
      <li><hr class="dropdown-divider"></li>
      <li><a class="dropdown-item">Ver perfil</a></li>
      <li><a class="dropdown-item text-danger" (click)="logout()">Cerrar sesiÃ³n</a></li>
    </ul>
  </div>
</header>

<nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
  <div class="container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#menuPrincipal">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="menuPrincipal">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link" href="#dashboard">ğŸ  Inicio</a></li>
        <li class="nav-item"><a class="nav-link" href="#calificaciones">ğŸ“‹ Calificaciones</a></li>
        <li class="nav-item"><a class="nav-link" href="#reportes">ğŸ“ˆ Reportes</a></li>
        <li class="nav-item"><a class="nav-link active fw-bold" href="#administracion">ğŸ› ï¸ AdministraciÃ³n</a></li>
      </ul>
    </div>
  </div>
</nav>

<main class="container my-4">

  <div class="security-note">
    âš ï¸ <strong>Recordatorio para el Administrador NUAM:</strong> Usted tiene control total sobre el sistema. 
    Puede crear, editar o eliminar usuarios, revisar auditorÃ­as y cambiar configuraciones generales.
  </div>

  <section id="administracion">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h5 class="text-primary mb-0">ğŸ› ï¸ AdministraciÃ³n del Sistema</h5>
      <button class="btn btn-outline-dark btn-sm">ğŸ“œ Ver auditorÃ­as del sistema</button>
    </div>

    <p class="text-muted small mb-3">
      En esta secciÃ³n puede gestionar usuarios, asignar roles, monitorear actividad reciente y mantener la seguridad del sistema NUAM.
    </p>

    <!-- Loading -->
    <div *ngIf="loading" class="text-center py-3">Cargando usuarios...</div>

    <!-- Error -->
    <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

    <!-- Tabla dinÃ¡mica -->
    <div class="table-responsive" *ngIf="!loading && !error">
      <table class="table table-striped align-middle">
        <thead class="table-dark">
          <tr>
            <th>Nombre</th>
            <th>Rol</th>
            <th>Correo</th>
            <th>Estado</th>
            <th>Acciones</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let u of usuarios">
            <td>{{ u.first_name }} {{ u.last_name }}</td>
            <td>{{ u.rol === 'ADMIN' ? 'Administrador NUAM' : 'Empleado NUAM' }}</td>
            <td>{{ u.email }}</td>

            <td>
              <span class="badge" [ngClass]="u.activo ? 'bg-success' : 'bg-secondary'">
                {{ u.activo ? 'Activo' : 'Bloqueado' }}
              </span>
            </td>

            <td>
              <button class="btn btn-sm btn-info action-btn">MÃ¡s info</button>
              <button class="btn btn-sm btn-warning action-btn">Editar rol</button>
              <button class="btn btn-sm btn-danger action-btn" *ngIf="u.activo">Bloquear</button>
              <button class="btn btn-sm btn-success action-btn" *ngIf="!u.activo">Desbloquear</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="text-end mt-3">
      <button class="btn btn-success">â• Agregar usuario</button>
    </div>
  </section>
</main>

<footer class="text-center py-3 mt-5 border-top">
  <small>Â© 2025 NUAM | MÃ³dulo de AdministraciÃ³n | Acceso exclusivo del Administrador del Sistema</small>
</footer>
